<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentences with Be Heard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #001184;
            --secondary: #eef2ff;
            --accent: #ff70a6;
            --success: #28a745;
            --error: #dc3545;
            --bg: #f8f9fe;
            --text: #2d3436;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .container { max-width: 1100px; margin: 0 auto; padding: 20px; }

        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--primary), #051aab);
            color: white;
            border-radius: 0 0 50px 50px;
            margin-bottom: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        /* --- Input Section --- */
        .card {
            background: white;
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }

        #input-area {
            width: 100%;
            min-height: 150px;
            border: 2px dashed #cbd5e0;
            border-radius: 15px;
            padding: 15px;
            font-size: 16px;
            outline: none;
            margin-bottom: 20px;
            box-sizing: border-box;
        }

        #input-area:focus { border-color: var(--primary); background: #fcfdff; }

        .btn-group { display: flex; gap: 15px; flex-wrap: wrap; }

        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
        }

        button:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,17,132,0.3); }
        .btn-alt { background-color: var(--accent); }

        /* --- Exercise Layout --- */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
            position: relative;
        }

        @media (max-width: 900px) {
            .main-layout { grid-template-columns: 1fr; }
            .word-bank-container { position: static !important; }
        }

        .sentence-card {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 18px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }

        .q-number {
            background: var(--secondary);
            color: var(--primary);
            font-weight: 700;
            min-width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .drop-zone {
            display: inline-block;
            min-width: 120px;
            border-bottom: 2px solid var(--primary);
            margin: 0 5px;
            text-align: center;
            font-weight: 700;
            color: var(--primary);
            cursor: pointer;
            background: #f0f3ff;
            border-radius: 8px 8px 0 0;
            padding: 2px 8px;
            height: 28px;
            vertical-align: bottom;
            transition: background 0.2s;
        }

        .drop-zone:hover { background: #e0e7ff; }

        /* --- Sticky Word Bank --- */
        .word-bank-container {
            position: sticky;
            top: 20px;
            height: fit-content;
        }

        .word-bank {
            background: white;
            padding: 20px;
            border-radius: 25px;
            border: 2px solid var(--secondary);
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        .word-bank h3 { margin-top: 0; color: var(--primary); font-size: 1.2rem; text-align: center; }

        .draggable-word {
            display: inline-block;
            background: white;
            padding: 8px 16px;
            margin: 6px;
            border-radius: 12px;
            cursor: grab;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            font-weight: 600;
            transition: all 0.2s;
        }

        .draggable-word.used {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
            background: #f1f5f9;
        }

        /* --- Feedback --- */
        .feedback-box { margin-top: 10px; border-top: 1px solid #eee; padding-top: 10px; font-size: 0.95rem; }
        .viet-sub { color: #636e72; font-style: italic; display: block; margin-top: 4px; }
        .correct-ans { color: var(--success); font-weight: 700; }
        .wrong-ans { color: var(--error); text-decoration: line-through; margin-right: 5px; }
        
        .score-banner {
            font-size: 2rem;
            text-align: center;
            color: var(--primary);
            margin-bottom: 30px;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

<header>
    <h1>H·ªçc t·ª´ qua c√¢u c√πng Be Heard</h1>
    <p>K√©o th·∫£ t·ª´ v√†o √¥ tr·ªëng ho·∫∑c nh·∫•p v√†o √¥ ƒë·ªÉ h·ªßy ch·ªçn</p>
</header>

<div class="container">
    <div id="setup-card" class="card">
        <div id="input-area" contenteditable="true" placeholder="D√°n vƒÉn b·∫£n c√≥ t·ª´ In ƒë·∫≠m (Bold) ho·∫∑c G·∫°ch ch√¢n (Underline) v√†o ƒë√¢y..."></div>
        <div class="btn-group">
            <input type="file" id="file-upload" accept=".docx" style="display:none">
            <button onclick="document.getElementById('file-upload').click()">üìÅ T·∫£i file .docx</button>
            <button class="btn-alt" onclick="startExercise()">üéØ B·∫Øt ƒë·∫ßu l√†m b√†i</button>
        </div>
    </div>

    <div id="exercise-view" class="hidden">
        <div class="main-layout">
            <div id="questions-list"></div>
            
            <div class="word-bank-container">
                <div class="word-bank">
                    <h3>Kho t·ª´ v·ª±ng</h3>
                    <div id="bank-content"></div>
                </div>
            </div>
        </div>
        <div style="text-align: center; margin-top: 40px;">
            <button id="submit-btn" style="padding: 15px 60px; font-size: 1.2rem;">N·ªôp b√†i</button>
        </div>
    </div>

    <div id="result-view" class="card hidden">
        <div id="score-text" class="score-banner"></div>
        <div id="detailed-results"></div>
        <div style="text-align: center; margin-top: 30px;">
            <button onclick="location.reload()">L√†m b√†i m·ªõi</button>
        </div>
    </div>
</div>

<script>
    /** --- C·∫§U H√åNH NG√ÇN H√ÄNG C√ÇU H·ªéI D·ª∞ PH√íNG --- */
    const FALLBACK_DATA = [
        { text: "The team had to **collaborate** closely to meet the project deadline.", trans: "Nh√≥m ƒë√£ ph·∫£i h·ª£p t√°c ch·∫∑t ch·∫Ω ƒë·ªÉ k·ªãp th·ªùi h·∫°n d·ª± √°n." },
        { text: "Her **meticulous** planning ensured the event was a huge success.", trans: "S·ª± l·∫≠p k·∫ø ho·∫°ch t·ªâ m·ªâ c·ªßa c√¥ ·∫•y ƒë√£ ƒë·∫£m b·∫£o s·ª± ki·ªán th√†nh c√¥ng r·ª±c r·ª°." },
        { text: "Scientists are trying to **ascertain** the cause of the phenomenon.", trans: "C√°c nh√† khoa h·ªçc ƒëang c·ªë g·∫Øng x√°c ƒë·ªãnh nguy√™n nh√¢n c·ªßa hi·ªán t∆∞·ª£ng n√†y." },
        { text: "The new law will **implement** stricter rules on waste disposal.", trans: "Lu·∫≠t m·ªõi s·∫Ω th·ª±c thi c√°c quy ƒë·ªãnh nghi√™m ng·∫∑t h∆°n v·ªÅ vi·ªác ƒë·ªï r√°c th·∫£i." },
        { text: "It is **inevitable** that technology will change the way we work.", trans: "Vi·ªác c√¥ng ngh·ªá thay ƒë·ªïi c√°ch ch√∫ng ta l√†m vi·ªác l√† ƒëi·ªÅu kh√¥ng th·ªÉ tr√°nh kh·ªèi." },
        { text: "The manager's **ambiguous** instructions led to many mistakes.", trans: "Nh·ªØng ch·ªâ d·∫´n m∆° h·ªì c·ªßa ng∆∞·ªùi qu·∫£n l√Ω ƒë√£ d·∫´n ƒë·∫øn nhi·ªÅu sai l·∫ßm." },
        { text: "Students are encouraged to **utilize** the library's online resources.", trans: "H·ªçc sinh ƒë∆∞·ª£c khuy·∫øn kh√≠ch t·∫≠n d·ª•ng c√°c ngu·ªìn t√†i nguy√™n tr·ª±c tuy·∫øn c·ªßa th∆∞ vi·ªán." },
        { text: "The company needs to **diversify** its products to reach more customers.", trans: "C√¥ng ty c·∫ßn ƒëa d·∫°ng h√≥a s·∫£n ph·∫©m ƒë·ªÉ ti·∫øp c·∫≠n nhi·ªÅu kh√°ch h√†ng h∆°n." },
        { text: "His **eloquent** speech moved many people in the audience.", trans: "B√†i ph√°t bi·ªÉu h√πng h·ªìn c·ªßa anh ·∫•y ƒë√£ l√†m lay ƒë·ªông nhi·ªÅu ng∆∞·ªùi trong kh√°n gi·∫£." },
        { text: "The government took measures to **alleviate** poverty in rural areas.", trans: "Ch√≠nh ph·ªß ƒë√£ th·ª±c hi·ªán c√°c bi·ªán ph√°p ƒë·ªÉ gi·∫£m b·ªõt ngh√®o ƒë√≥i ·ªü c√°c v√πng n√¥ng th√¥n." },
        { text: "The data shows a **significant** increase in online sales this year.", trans: "D·ªØ li·ªáu cho th·∫•y m·ªôt s·ª± gia tƒÉng ƒë√°ng k·ªÉ trong doanh s·ªë b√°n h√†ng tr·ª±c tuy·∫øn nƒÉm nay." },
        { text: "She has a **pragmatic** approach to solving complex problems.", trans: "C√¥ ·∫•y c√≥ m·ªôt c√°ch ti·∫øp c·∫≠n th·ª±c t·∫ø ƒë·ªÉ gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ ph·ª©c t·∫°p." },
        { text: "We must **evaluate** the results before making a final decision.", trans: "Ch√∫ng ta ph·∫£i ƒë√°nh gi√° k·∫øt qu·∫£ tr∆∞·ªõc khi ƒë∆∞a ra quy·∫øt ƒë·ªãnh cu·ªëi c√πng." },
        { text: "The building's **infrastructure** was damaged during the storm.", trans: "C∆° s·ªü h·∫° t·∫ßng c·ªßa t√≤a nh√† ƒë√£ b·ªã h∆∞ h·∫°i trong c∆°n b√£o." },
        { text: "He is a **versatile** actor who can play both comedy and drama.", trans: "Anh ·∫•y l√† m·ªôt di·ªÖn vi√™n linh ho·∫°t, c√≥ th·ªÉ ƒë√≥ng c·∫£ h√†i k·ªãch v√† bi k·ªãch." },
        { text: "The CEO decided to **consolidate** the two departments to improve efficiency.", trans: "Gi√°m ƒë·ªëc ƒëi·ªÅu h√†nh quy·∫øt ƒë·ªãnh h·ª£p nh·∫•t hai b·ªô ph·∫≠n ƒë·ªÉ c·∫£i thi·ªán hi·ªáu qu·∫£." },
        { text: "Heavy rain might **jeopardize** our chances of finishing the construction.", trans: "M∆∞a l·ªõn c√≥ th·ªÉ g√¢y nguy hi·ªÉm cho c∆° h·ªôi ho√†n th√†nh c√¥ng tr√¨nh c·ªßa ch√∫ng ta." },
        { text: "The report offers a **comprehensive** analysis of the current market.", trans: "B·∫£n b√°o c√°o ƒë∆∞a ra m·ªôt ph√¢n t√≠ch to√†n di·ªán v·ªÅ th·ªã tr∆∞·ªùng hi·ªán t·∫°i." },
        { text: "The witness provided **contradictory** statements during the trial.", trans: "Nh√¢n ch·ª©ng ƒë√£ ƒë∆∞a ra nh·ªØng l·ªùi khai m√¢u thu·∫´n trong phi√™n t√≤a." },
        { text: "Digital transformation can **exacerbate** the gap between rich and poor.", trans: "Chuy·ªÉn ƒë·ªïi k·ªπ thu·∫≠t s·ªë c√≥ th·ªÉ l√†m tr·∫ßm tr·ªçng th√™m kho·∫£ng c√°ch gi√†u ngh√®o." },
        { text: "After hours of debate, the board finally reached a **consensus**.", trans: "Sau nhi·ªÅu gi·ªù tranh lu·∫≠n, h·ªôi ƒë·ªìng qu·∫£n tr·ªã cu·ªëi c√πng ƒë√£ ƒë·∫°t ƒë∆∞·ª£c s·ª± ƒë·ªìng thu·∫≠n." },
        { text: "High interest rates often **deter** people from taking out loans.", trans: "L√£i su·∫•t cao th∆∞·ªùng ngƒÉn c·∫£n m·ªçi ng∆∞·ªùi vay v·ªën." },
        { text: "The school aims to **foster** a sense of community among students.", trans: "Nh√† tr∆∞·ªùng nh·∫±m m·ª•c ƒë√≠ch nu√¥i d∆∞·ª°ng √Ω th·ª©c c·ªông ƒë·ªìng trong h·ªçc sinh." },
        { text: "The project was cancelled due to a **deficit** in the annual budget.", trans: "D·ª± √°n b·ªã h·ªßy b·ªè do th√¢m h·ª•t ng√¢n s√°ch h√†ng nƒÉm." },
        { text: "Her **unprecedented** success inspired many young entrepreneurs.", trans: "Th√†nh c√¥ng ch∆∞a t·ª´ng c√≥ c·ªßa c√¥ ƒë√£ truy·ªÅn c·∫£m h·ª©ng cho nhi·ªÅu doanh nh√¢n tr·∫ª." },
        { text: "The lawyer tried to **elucidate** the complex terms of the contract.", trans: "Lu·∫≠t s∆∞ c·ªë g·∫Øng gi·∫£i th√≠ch r√µ r√†ng c√°c ƒëi·ªÅu kho·∫£n ph·ª©c t·∫°p c·ªßa h·ª£p ƒë·ªìng." },
        { text: "There is no **tangible** evidence to support your accusations.", trans: "Kh√¥ng c√≥ b·∫±ng ch·ª©ng h·ªØu h√¨nh n√†o h·ªó tr·ª£ cho nh·ªØng l·ªùi c√°o bu·ªôc c·ªßa b·∫°n." },
        { text: "The local residents are **indigenous** to this mountainous region.", trans: "Nh·ªØng ng∆∞·ªùi d√¢n ƒë·ªãa ph∆∞∆°ng l√† ng∆∞·ªùi b·∫£n ƒë·ªãa c·ªßa v√πng n√∫i n√†y." },
        { text: "Artificial Intelligence is a **burgeoning** field with many job openings.", trans: "Tr√≠ tu·ªá nh√¢n t·∫°o l√† m·ªôt lƒ©nh v·ª±c ƒëang ph√°t tri·ªÉn nhanh ch√≥ng v·ªõi nhi·ªÅu c∆° h·ªôi vi·ªác l√†m." },
        { text: "The researchers found a **correlation** between stress and heart disease.", trans: "C√°c nh√† nghi√™n c·ª©u ƒë√£ t√¨m th·∫•y m·ªëi t∆∞∆°ng quan gi·ªØa cƒÉng th·∫≥ng v√† b·ªánh tim." },
        { text: "The government should **subsidize** public transport to reduce pollution.", trans: "Ch√≠nh ph·ªß n√™n tr·ª£ gi√° cho ph∆∞∆°ng ti·ªán c√¥ng c·ªông ƒë·ªÉ gi·∫£m √¥ nhi·ªÖm." },
        { text: "He is **oblivious** to the fact that everyone is laughing at him.", trans: "Anh ta kh√¥ng h·ªÅ hay bi·∫øt s·ª± th·∫≠t r·∫±ng m·ªçi ng∆∞·ªùi ƒëang c∆∞·ªùi nh·∫°o m√¨nh." },
        { text: "The medicine will **mitigate** the symptoms but won't cure the cold.", trans: "Thu·ªëc s·∫Ω l√†m gi·∫£m c√°c tri·ªáu ch·ª©ng nh∆∞ng kh√¥ng ch·ªØa kh·ªèi b·ªánh c·∫£m l·∫°nh." },
        { text: "The company's profits began to **fluctuate** wildly last quarter.", trans: "L·ª£i nhu·∫≠n c·ªßa c√¥ng ty b·∫Øt ƒë·∫ßu dao ƒë·ªông d·ªØ d·ªôi trong qu√Ω v·ª´a qua." },
        { text: "Working in a call center can be extremely **monotonous**.", trans: "L√†m vi·ªác t·∫°i trung t√¢m cu·ªôc g·ªçi c√≥ th·ªÉ v√¥ c√πng ƒë∆°n ƒëi·ªáu." },
        { text: "They need to **refurbish** the old office before moving back in.", trans: "H·ªç c·∫ßn t√¢n trang l·∫°i vƒÉn ph√≤ng c≈© tr∆∞·ªõc khi d·ªùi l·∫°i v√†o ƒë√≥." },
        { text: "The speaker's voice was barely **audible** over the noise of the crowd.", trans: "Gi·ªçng n√≥i c·ªßa ng∆∞·ªùi di·ªÖn thuy·∫øt h·∫ßu nh∆∞ kh√¥ng th·ªÉ nghe th·∫•y ƒë∆∞·ª£c v√¨ ti·∫øng ·ªìn c·ªßa ƒë√°m ƒë√¥ng." },
        { text: "Education is a **fundamental** right for every human being.", trans: "Gi√°o d·ª•c l√† quy·ªÅn c∆° b·∫£n c·ªßa m·ªói con ng∆∞·ªùi." },
        { text: "She was **apprehensive** about her first day in the new position.", trans: "C√¥ ·∫•y c·∫£m th·∫•y lo l·∫Øng v·ªÅ ng√†y ƒë·∫ßu ti√™n ·ªü v·ªã tr√≠ m·ªõi." },
        { text: "The teacher gave us **explicit** instructions on how to write the essay.", trans: "Gi√°o vi√™n ƒë√£ cho ch√∫ng t√¥i nh·ªØng ch·ªâ d·∫´n r√µ r√†ng v·ªÅ c√°ch vi·∫øt b√†i lu·∫≠n." },
        { text: "His theory is purely **hypothetical** and has not been tested yet.", trans: "L√Ω thuy·∫øt c·ªßa √¥ng ho√†n to√†n mang t√≠nh gi·∫£ thuy·∫øt v√† v·∫´n ch∆∞a ƒë∆∞·ª£c ki·ªÉm ch·ª©ng." },
        { text: "We need to **scrutinize** the documents for any potential errors.", trans: "Ch√∫ng ta c·∫ßn ki·ªÉm tra k·ªπ l∆∞·ª°ng c√°c t√†i li·ªáu ƒë·ªÉ t√¨m ra b·∫•t k·ª≥ l·ªói ti·ªÅm ·∫©n n√†o." },
        { text: "A healthy diet is **beneficial** for your overall well-being.", trans: "Ch·∫ø ƒë·ªô ƒÉn u·ªëng l√†nh m·∫°nh c√≥ l·ª£i cho s·ª©c kh·ªèe t·ªïng th·ªÉ c·ªßa b·∫°n." },
        { text: "The instructions were so **convoluted** that nobody understood them.", trans: "C√°c h∆∞·ªõng d·∫´n qu√° r·∫Øc r·ªëi ƒë·∫øn n·ªói kh√¥ng ai hi·ªÉu ƒë∆∞·ª£c ch√∫ng." },
        { text: "She handled the difficult situation with great **discretion**.", trans: "C√¥ ·∫•y ƒë√£ x·ª≠ l√Ω t√¨nh hu·ªëng kh√≥ khƒÉn v·ªõi s·ª± th·∫≠n tr·ªçng tuy·ªát v·ªùi." },
        { text: "It is often **counterproductive** to work late into the night.", trans: "L√†m vi·ªác mu·ªôn v√†o ƒë√™m th∆∞·ªùng ph·∫£n t√°c d·ª•ng." },
        { text: "The judge's decision was **impartial** and based only on facts.", trans: "Quy·∫øt ƒë·ªãnh c·ªßa th·∫©m ph√°n l√† c√¥ng t√¢m v√† ch·ªâ d·ª±a tr√™n s·ª± th·∫≠t." },
        { text: "This software is **compatible** with most operating systems.", trans: "Ph·∫ßn m·ªÅm n√†y t∆∞∆°ng th√≠ch v·ªõi h·∫ßu h·∫øt c√°c h·ªá ƒëi·ªÅu h√†nh." },
        { text: "The smell of fresh bread is **pervasive** in the bakery.", trans: "M√πi b√°nh m√¨ t∆∞∆°i lan t·ªèa kh·∫Øp ti·ªám b√°nh." },
        { text: "Her **resilience** helped her overcome the tragedy and move on.", trans: "S·ª± ki√™n c∆∞·ªùng ƒë√£ gi√∫p c√¥ v∆∞·ª£t qua bi k·ªãch v√† ti·∫øp t·ª•c s·ªëng." },
        { text: "The country enjoys a period of great **prosperity** thanks to trade.", trans: "ƒê·∫•t n∆∞·ªõc t·∫≠n h∆∞·ªüng m·ªôt th·ªùi k·ª≥ th·ªãnh v∆∞·ª£ng l·ªõn nh·ªù v√†o th∆∞∆°ng m·∫°i." },
        { text: "You must **adhere** to the safety regulations at all times.", trans: "B·∫°n ph·∫£i tu√¢n th·ªß c√°c quy ƒë·ªãnh an to√†n v√†o m·ªçi l√∫c." },
        { text: "The internet has become **ubiquitous** in modern society.", trans: "Internet ƒë√£ tr·ªü n√™n ph·ªï bi·∫øn kh·∫Øp m·ªçi n∆°i trong x√£ h·ªôi hi·ªán ƒë·∫°i." },
        { text: "His contribution to the project was **invaluable**.", trans: "S·ª± ƒë√≥ng g√≥p c·ªßa anh ·∫•y cho d·ª± √°n l√† v√¥ gi√°." },
        { text: "Environmentalists **advocate** for the protection of marine life.", trans: "C√°c nh√† m√¥i tr∆∞·ªùng h·ªçc ·ªßng h·ªô vi·ªác b·∫£o v·ªá sinh v·∫≠t bi·ªÉn." },
        { text: "The results of the experiment were **anomalous** and unexpected.", trans: "K·∫øt qu·∫£ c·ªßa cu·ªôc th√≠ nghi·ªám l√† b·∫•t th∆∞·ªùng v√† kh√¥ng mong ƒë·ª£i." },
        { text: "The selection process seemed completely **arbitrary** to the applicants.", trans: "Qu√° tr√¨nh l·ª±a ch·ªçn d∆∞·ªùng nh∆∞ ho√†n to√†n t√πy ti·ªán ƒë·ªëi v·ªõi c√°c ·ª©ng vi√™n." },
        { text: "Fluency in English is a major **asset** in today's job market.", trans: "Th√¥ng th·∫°o ti·∫øng Anh l√† m·ªôt t√†i s·∫£n l·ªõn trong th·ªã tr∆∞·ªùng vi·ªác l√†m ng√†y nay." },
        { text: "He is an **assiduous** worker who never misses a detail.", trans: "Anh ·∫•y l√† m·ªôt nh√¢n vi√™n si√™ng nƒÉng, ng∆∞·ªùi kh√¥ng bao gi·ªù b·ªè l·ª° m·ªôt chi ti·∫øt n√†o." },
        { text: "The company plans to **augment** its staff by hiring more experts.", trans: "C√¥ng ty c√≥ k·∫ø ho·∫°ch tƒÉng c∆∞·ªùng nh√¢n s·ª± b·∫±ng c√°ch thu√™ th√™m chuy√™n gia." },
        { text: "Local councils were given more **autonomy** to manage their budgets.", trans: "C√°c h·ªôi ƒë·ªìng ƒë·ªãa ph∆∞∆°ng ƒë√£ ƒë∆∞·ª£c trao quy·ªÅn t·ª± ch·ªß nhi·ªÅu h∆°n ƒë·ªÉ qu·∫£n l√Ω ng√¢n s√°ch." },
        { text: "The billionaire is known for his **benevolent** donations to charity.", trans: "V·ªã t·ª∑ ph√∫ n·ªïi ti·∫øng v·ªõi nh·ªØng kho·∫£n quy√™n g√≥p nh√¢n t·ª´ cho t·ª´ thi·ªán." },
        { text: "I was completely **bewildered** by the complex instructions.", trans: "T√¥i ho√†n to√†n b·ªã b·ªëi r·ªëi b·ªüi nh·ªØng ch·ªâ d·∫´n ph·ª©c t·∫°p." },
        { text: "To be **candid**, I don't think this plan will work.", trans: "N√≥i th·∫≥ng th·∫Øn th√¨ t√¥i kh√¥ng nghƒ© k·∫ø ho·∫°ch n√†y s·∫Ω hi·ªáu qu·∫£." },
        { text: "A **cohesive** team is essential for the success of any startup.", trans: "M·ªôt ƒë·ªôi ng≈© g·∫Øn k·∫øt l√† ƒëi·ªÅu c·∫ßn thi·∫øt cho s·ª± th√†nh c√¥ng c·ªßa b·∫•t k·ª≥ kh·ªüi nghi·ªáp n√†o." },
        { text: "We are **cognizant** of the difficulties involved in this task.", trans: "Ch√∫ng t√¥i nh·∫≠n th·ª©c r√µ nh·ªØng kh√≥ khƒÉn li√™n quan ƒë·∫øn nhi·ªám v·ª• n√†y." },
        { text: "Salary should be **commensurate** with experience and skills.", trans: "L∆∞∆°ng b·ªïng n√™n t∆∞∆°ng x·ª©ng v·ªõi kinh nghi·ªám v√† k·ªπ nƒÉng." },
        { text: "We cannot afford to become **complacent** about our achievements.", trans: "Ch√∫ng ta kh√¥ng ƒë∆∞·ª£c ph√©p tr·ªü n√™n t·ª± m√£n v·ªÅ nh·ªØng th√†nh t·ª±u c·ªßa m√¨nh." },
        { text: "Please keep your presentation **concise** and to the point.", trans: "Vui l√≤ng gi·ªØ cho b√†i thuy·∫øt tr√¨nh ng·∫Øn g·ªçn v√† ƒëi th·∫≥ng v√†o v·∫•n ƒë·ªÅ." },
        { text: "The school does not **condone** any form of bullying.", trans: "Nh√† tr∆∞·ªùng kh√¥ng bao dung cho b·∫•t k·ª≥ h√¨nh th·ª©c b·∫Øt n·∫°t n√†o." },
        { text: "The quiet atmosphere is **conducive** to studying.", trans: "B·∫ßu kh√¥ng kh√≠ y√™n tƒ©nh r·∫•t c√≥ l·ª£i cho vi·ªác h·ªçc t·∫≠p." },
        { text: "He is a **conscientious** student who always finishes his homework.", trans: "C·∫≠u ·∫•y l√† m·ªôt h·ªçc sinh t·∫≠n t√¢m, lu√¥n ho√†n th√†nh b√†i t·∫≠p v·ªÅ nh√†." },
        { text: "The red tower is a **conspicuous** landmark in the city.", trans: "T√≤a th√°p ƒë·ªè l√† m·ªôt c·ªôt m·ªëc d·ªÖ th·∫•y trong th√†nh ph·ªë." },
        { text: "Budget **constraints** prevented us from upgrading the equipment.", trans: "Nh·ªØng h·∫°n ch·∫ø v·ªÅ ng√¢n s√°ch ƒë√£ ngƒÉn c·∫£n ch√∫ng t√¥i n√¢ng c·∫•p thi·∫øt b·ªã." },
        { text: "She took a moment to **contemplate** her future career path.", trans: "C√¥ ·∫•y d√†nh m·ªôt ch√∫t th·ªùi gian ƒë·ªÉ suy ng·∫´m v·ªÅ con ƒë∆∞·ªùng s·ª± nghi·ªáp t∆∞∆°ng lai." },
        { text: "He preferred a **conventional** wedding over a modern one.", trans: "Anh ·∫•y th√≠ch m·ªôt ƒë√°m c∆∞·ªõi truy·ªÅn th·ªëng h∆°n l√† m·ªôt ƒë√°m c∆∞·ªõi hi·ªán ƒë·∫°i." },
        { text: "The staff always gave us a **cordial** welcome at the hotel.", trans: "Nh√¢n vi√™n lu√¥n d√†nh cho ch√∫ng t√¥i s·ª± ch√†o ƒë√≥n n·ªìng h·∫≠u t·∫°i kh√°ch s·∫°n." },
        { text: "Quality is the main **criterion** for selecting the winner.", trans: "Ch·∫•t l∆∞·ª£ng l√† ti√™u ch√≠ ch√≠nh ƒë·ªÉ l·ª±a ch·ªçn ng∆∞·ªùi chi·∫øn th·∫Øng." },
        { text: "The old filing system was **cumbersome** and slow.", trans: "H·ªá th·ªëng l∆∞u tr·ªØ c≈© r·∫•t c·ªìng k·ªÅnh v√† ch·∫≠m ch·∫°p." },
        { text: "The company had to **curtail** its spending due to the recession.", trans: "C√¥ng ty ƒë√£ ph·∫£i c·∫Øt gi·∫£m chi ti√™u do suy tho√°i kinh t·∫ø." },
        { text: "She felt **daunted** by the sheer amount of work ahead.", trans: "C√¥ c·∫£m th·∫•y n·∫£n l√≤ng tr∆∞·ªõc l∆∞·ª£ng c√¥ng vi·ªác kh·ªïng l·ªì ph√≠a tr∆∞·ªõc." },
        { text: "The patient suffered from a **debilitating** illness for years.", trans: "B·ªánh nh√¢n ƒë√£ ph·∫£i ch·ªãu ƒë·ª±ng m·ªôt cƒÉn b·ªánh l√†m suy nh∆∞·ª£c trong nhi·ªÅu nƒÉm." },
        { text: "It was difficult to **decipher** his messy handwriting.", trans: "R·∫•t kh√≥ ƒë·ªÉ gi·∫£i m√£ ch·ªØ vi·∫øt tay c·∫©u th·∫£ c·ªßa anh ta." },
        { text: "He showed great **deference** to his elders.", trans: "Anh ·∫•y th·ªÉ hi·ªán s·ª± t√¥n tr·ªçng l·ªõn ƒë·ªëi v·ªõi nh·ªØng ng∆∞·ªùi l·ªõn tu·ªïi." },
        { text: "Vitamin **deficiency** can lead to various health problems.", trans: "Thi·∫øu h·ª•t vitamin c√≥ th·ªÉ d·∫´n ƒë·∫øn nhi·ªÅu v·∫•n ƒë·ªÅ s·ª©c kh·ªèe kh√°c nhau." },
        { text: "Smoking has a **deleterious** effect on your lungs.", trans: "H√∫t thu·ªëc c√≥ t√°c ƒë·ªông c√≥ h·∫°i l√™n ph·ªïi c·ªßa b·∫°n." },
        { text: "Her professional **demeanor** impressed the hiring manager.", trans: "Th√°i ƒë·ªô chuy√™n nghi·ªáp c·ªßa c√¥ ·∫•y ƒë√£ g√¢y ·∫•n t∆∞·ª£ng v·ªõi qu·∫£n l√Ω tuy·ªÉn d·ª•ng." },
        { text: "The community rose up to **denounce** the violent attacks.", trans: "C·ªông ƒë·ªìng ƒë√£ ƒë·ª©ng l√™n ƒë·ªÉ l√™n √°n c√°c cu·ªôc t·∫•n c√¥ng b·∫°o l·ª±c." },
        { text: "If we continue to **deplete** natural resources, we will face a crisis.", trans: "N·∫øu ch√∫ng ta ti·∫øp t·ª•c l√†m c·∫°n ki·ªát t√†i nguy√™n thi√™n nhi√™n, ch√∫ng ta s·∫Ω ƒë·ªëi m·∫∑t v·ªõi kh·ªßng ho·∫£ng." },
        { text: "Critics often **deride** his films for being too predictable.", trans: "C√°c nh√† ph√™ b√¨nh th∆∞·ªùng ch·∫ø nh·∫°o c√°c b·ªô phim c·ªßa √¥ng v√¨ qu√° d·ªÖ ƒëo√°n." },
        { text: "She grew **despondent** after failing the exam for the third time.", trans: "C√¥ ·∫•y tr·ªü n√™n tuy·ªát v·ªçng sau khi tr∆∞·ª£t k·ª≥ thi l·∫ßn th·ª© ba." },
        { text: "Excessive sugar consumption is **detrimental** to your teeth.", trans: "Ti√™u th·ª• qu√° nhi·ªÅu ƒë∆∞·ªùng c√≥ h·∫°i cho rƒÉng c·ªßa b·∫°n." },
        { text: "Do not **deviate** from the path, or you might get lost.", trans: "ƒê·ª´ng ƒëi ch·ªách kh·ªèi con ƒë∆∞·ªùng, n·∫øu kh√¥ng b·∫°n c√≥ th·ªÉ b·ªã l·∫°c." },
        { text: "He is a **diligent** student who studies late every night.", trans: "C·∫≠u ·∫•y l√† m·ªôt h·ªçc sinh c·∫ßn c√π, h·ªçc b√†i mu·ªôn m·ªói ƒë√™m." },
        { text: "The pain will **diminish** after you take the medicine.", trans: "C∆°n ƒëau s·∫Ω gi·∫£m b·ªõt sau khi b·∫°n u·ªëng thu·ªëc." },
        { text: "There is a large **discrepancy** between the two reports.", trans: "C√≥ m·ªôt s·ª± kh√°c bi·ªát l·ªõn gi·ªØa hai b·∫£n b√°o c√°o." },
        { text: "The doctor was very **discreet** about the patient's condition.", trans: "B√°c sƒ© r·∫•t k√≠n ƒë√°o v·ªÅ t√¨nh tr·∫°ng c·ªßa b·ªánh nh√¢n." },
        { text: "He looked at the cheap imitation with **disdain**.", trans: "Anh ·∫•y nh√¨n m√≥n ƒë·ªì gi·∫£ r·∫ª ti·ªÅn v·ªõi s·ª± khinh mi·ªát." },
        { text: "The mechanic had to **dismantle** the engine to find the fault.", trans: "Th·ª£ m√°y ƒë√£ ph·∫£i th√°o d·ª° ƒë·ªông c∆° ƒë·ªÉ t√¨m ra l·ªói." },
        { text: "The goal of the seminar is to **disseminate** new research findings.", trans: "M·ª•c ti√™u c·ªßa cu·ªôc h·ªôi th·∫£o l√† ph·ªï bi·∫øn c√°c k·∫øt qu·∫£ nghi√™n c·ª©u m·ªõi." },
        { text: "The two friends took **divergent** paths after graduating.", trans: "Hai ng∆∞·ªùi b·∫°n ƒë√£ ƒëi theo nh·ªØng con ƒë∆∞·ªùng kh√°c nhau sau khi t·ªët nghi·ªáp." }

    ];

    let currentQuestions = [];

    // ƒê·ªçc file .docx
    document.getElementById('file-upload').addEventListener('change', function(e) {
        const reader = new FileReader();
        reader.onload = function(event) {
            mammoth.convertToHtml({arrayBuffer: event.target.result})
                .then(result => { document.getElementById('input-area').innerHTML = result.value; });
        };
        reader.readAsArrayBuffer(this.files[0]);
    });

    function startExercise() {
        const inputDiv = document.getElementById('input-area');
        const extracted = [];
        
        // Tr√≠ch xu·∫•t t·ª´ b, strong, u
        const nodes = inputDiv.querySelectorAll('b, strong, u, span[style*="underline"]');
        nodes.forEach(node => {
            let word = node.innerText.trim();
            let fullSentence = node.parentElement.innerText;
            if(word.length > 1) {
                extracted.push({ answer: word, text: fullSentence, trans: "C√¢u t·ª´ d·ªØ li·ªáu ng∆∞·ªùi d√πng" });
            }
        });

        // Tr·ªôn v√† l·∫•y ƒë·ªß 15 c√¢u
        let pool = [...extracted];
        if(pool.length < 15) {
            const extra = FALLBACK_DATA.sort(() => 0.5 - Math.random()).slice(0, 15 - pool.length);
            extra.forEach(item => {
                pool.push({
                    answer: item.text.match(/\*\*(.*?)\*\*/)[1],
                    text: item.text.replace(/\*\*/g, ''),
                    trans: item.trans
                });
            });
        }

        currentQuestions = pool.slice(0, 15).sort(() => 0.5 - Math.random());
        renderUI();
    }

    function renderUI() {
        const list = document.getElementById('questions-list');
        const bank = document.getElementById('bank-content');
        list.innerHTML = '';
        bank.innerHTML = '';

        currentQuestions.forEach((q, idx) => {
            const div = document.createElement('div');
            div.className = 'sentence-card';
            
            // T·∫°o c√¢u c√≥ √¥ tr·ªëng
            const blankHtml = `<span class="drop-zone" data-id="${idx}" onclick="removeWord(this)" ondrop="drop(event)" ondragover="allowDrop(event)"></span>`;
            const regex = new RegExp(`\\b${q.answer}\\b`, 'i');
            const sentenceHtml = q.text.replace(regex, blankHtml);

            div.innerHTML = `<div class="q-number">${idx + 1}</div><div>${sentenceHtml}</div>`;
            list.appendChild(div);
        });

        // T·∫°o Word Bank (lu√¥n hi·ªÉn th·ªã to√†n b·ªô)
        const allWords = currentQuestions.map(q => q.answer).sort();
        allWords.forEach((word, idx) => {
            const span = document.createElement('span');
            span.className = 'draggable-word';
            span.innerText = word;
            span.draggable = true;
            span.id = `word-item-${idx}`;
            span.ondragstart = drag;
            bank.appendChild(span);
        });

        document.getElementById('setup-card').classList.add('hidden');
        document.getElementById('exercise-view').classList.remove('hidden');
    }

    /* --- LOGIC K√âO TH·∫¢ & CLICK --- */
    function allowDrop(ev) { ev.preventDefault(); }

    function drag(ev) {
        ev.dataTransfer.setData("textId", ev.target.id);
        ev.dataTransfer.setData("word", ev.target.innerText);
    }

    function drop(ev) {
        ev.preventDefault();
        const word = ev.dataTransfer.getData("word");
        const elementId = ev.dataTransfer.getData("textId");

        // N·∫øu √¥ ƒë√£ c√≥ t·ª´, tr·∫£ t·ª´ c≈© v·ªÅ bank tr∆∞·ªõc
        if(ev.target.innerText !== "") {
            toggleBankWord(ev.target.innerText, false);
        }

        ev.target.innerText = word;
        toggleBankWord(word, true); // L√†m m·ªù t·ª´ trong kho
    }

    // Nh·∫•p v√†o √¥ tr·ªëng ƒë·ªÉ x√≥a t·ª´
    function removeWord(el) {
        if(el.innerText !== "") {
            toggleBankWord(el.innerText, false); // Hi·ªán l·∫°i trong kho
            el.innerText = "";
        }
    }

    // H√†m ·∫©n/hi·ªán t·ª´ trong kho
    function toggleBankWord(word, isUsed) {
        const bankWords = document.querySelectorAll('.draggable-word');
        for(let bw of bankWords) {
            if(bw.innerText === word && bw.classList.contains('used') === !isUsed) {
                if(isUsed) bw.classList.add('used');
                else bw.classList.remove('used');
                break;
            }
        }
    }

    /* --- N·ªòP B√ÄI --- */
    document.getElementById('submit-btn').onclick = function() {
        let score = 0;
        const resultContainer = document.getElementById('detailed-results');
        resultContainer.innerHTML = '';

        currentQuestions.forEach((q, idx) => {
            const userAns = document.querySelector(`.drop-zone[data-id="${idx}"]`).innerText.trim();
            const isCorrect = userAns.toLowerCase() === q.answer.toLowerCase();
            if(isCorrect) score++;

            const div = document.createElement('div');
            div.className = 'sentence-card';
            div.innerHTML = `
                <div class="q-number">${idx + 1}</div>
                <div style="width:100%">
                    <p style="margin:0">
                        ${isCorrect ? '‚úÖ' : '‚ùå'} 
                        ${q.text.replace(q.answer, `<span class="correct-ans">${q.answer}</span>`)}
                    </p>
                    <div class="feedback-box">
                        <span>ƒê√°p √°n c·ªßa b·∫°n: <span class="${isCorrect ? 'correct-ans' : 'wrong-ans'}">${userAns || "Tr·ªëng"}</span></span>
                        <small class="viet-sub">${q.trans}</small>
                    </div>
                </div>
            `;
            resultContainer.appendChild(div);
        });

        const percent = Math.round((score / 15) * 100);
        document.getElementById('score-text').innerText = `K·∫øt qu·∫£: ${score}/15 (${percent}%)`;
        document.getElementById('exercise-view').classList.add('hidden');
        document.getElementById('result-view').classList.remove('hidden');
        window.scrollTo(0,0);
    };
</script>

</body>
</html>